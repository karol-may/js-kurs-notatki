<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <title>{{ page.title }} | {{ site.title }}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{{ '/assets/css/style.css' | relative_url }}">
  </head>
  <body>
    {% include header.html %}
    <main style="max-width: 960px; margin: 2rem auto; padding: 1rem;">
      {{ content }}

      {% assign all_lessons = site.pages | where_exp: "page", "page.url contains '/lessons/'" | sort: "title" %}
      {% assign current_index = all_lessons | index_of: page %}
      <div style="margin-top: 3rem; border-top: 1px solid #ccc; padding-top: 1rem; font-size: 0.9rem;">
        {% if current_index > 0 %}
          <a href="{{ all_lessons[current_index | minus: 1].url }}">⬅ Poprzednia: {{ all_lessons[current_index | minus: 1].title }}</a>
        {% endif %}
        {% if current_index < all_lessons.size | minus: 1 %}
          <span style="float: right;">
            <a href="{{ all_lessons[current_index | plus: 1].url }}">Następna: {{ all_lessons[current_index | plus: 1].title }} ➡</a>
          </span>
        {% endif %}
      </div>
    </main>
    <footer style="text-align:center; font-size: 0.8rem; color: #888; margin-top: 2rem;">
      &copy; 2025 Karol May
    </footer>
    <script src="{{ '/assets/js/dark-mode.js' | relative_url }}"></script>
  
<script>
document.addEventListener("DOMContentLoaded", function () {
  const content = document.querySelector("main");
  const headers = content.querySelectorAll("h2, h3");
  if (!headers.length) return;

  const toc = document.createElement("div");
  toc.style.position = "sticky";
  toc.style.top = "1rem";
  toc.style.maxHeight = "80vh";
  toc.style.overflowY = "auto";
  toc.style.padding = "1rem";
  toc.style.border = "1px solid #ccc";
  toc.style.background = "#f9f9f9";
  toc.style.marginBottom = "2rem";
  toc.style.fontSize = "0.9rem";

  toc.innerHTML = "<strong>Spis treści</strong><ul></ul>";
  const ul = toc.querySelector("ul");

  headers.forEach(header => {
    const id = header.textContent.toLowerCase().replace(/[^a-z0-9]+/g, "-");
    header.id = id;
    const li = document.createElement("li");
    li.innerHTML = `<a href="#${id}">${header.textContent}</a>`;
    ul.appendChild(li);
  });

  content.insertBefore(toc, content.firstChild);
});
</script>

  </body>
</html>
